	/**
	 * Build the chart from configuration
	 * 
	 * @return a new chart
	 */
	private Chart produceChart()
	{	
		IStructuredSelection selection = (IStructuredSelection)stViewer.getViewer().getSelection();
		if (selection == StructuredSelection.EMPTY) return null;
		Object[] objects = selection.toArray();
		
		ISTDataViewersField labelField = getLabelField(stViewer);

		
		List<IChartField> selectedFields = new ArrayList<IChartField>();
		for (Button button : columnButtons) {
			if (button.getSelection()) {
				selectedFields.add((IChartField)button.getData());
			}
		}
		boolean barChartType = barGraphButton.getSelection();
		boolean horizontalBars = !verticalBarsButton.getSelection();
		
		if (barChartType) {
			return ChartFactory.produceBarChart(objects, labelField, selectedFields, getBarChartTitle(),horizontalBars);
		}
		else {
			return ChartFactory.producePieChart(objects, labelField, selectedFields);
		}
	}

